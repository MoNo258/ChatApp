(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{25:function(e,t,a){e.exports=a(42)},41:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),l=a.n(s),c=a(18),i=a(2),o=a(5);const m=a(30);a(31),a(33);m.initializeApp({apiKey:"AIzaSyDXa0fgtPdooYjor8GB3xIVD_HZyxKBftU",authDomain:"chatapp-1fe70.firebaseapp.com",databaseURL:"https://chatapp-1fe70.firebaseio.com"});const u=m.auth,h=m.database();var p=function(){return r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar navbar-expand-sm fixed-top navbar-light"},r.a.createElement(o.b,{to:"/",className:"navbar-brand"},"ChatApp"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNavAltMarkup"},u().currentUser?r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(o.b,{to:"/chat",className:"nav-item nav-link mr-3"},"Profile"),r.a.createElement("button",{className:"btn btn-primary mr-3",onClick:()=>u().signOut()},"Logout")):r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(o.b,{to:"/login",className:"nav-item nav-link mr-3"},"Login"),r.a.createElement(o.b,{to:"/signup",className:"nav-item nav-link mr-3"},"Sign Up")))))};var d=function(){return r.a.createElement("footer",{className:"pt-5"},r.a.createElement("div",{className:"container text-center"},r.a.createElement("p",null,"\xa9 ChatApp 2020 :)")))};class g extends n.Component{render(){return r.a.createElement("div",{className:"home"},r.a.createElement(p,null),r.a.createElement("section",null,r.a.createElement("div",{className:"jumbotron jumbotron-fluid py-5"},r.a.createElement("div",{className:"container text-center py-5"},r.a.createElement("h1",{className:"display-4"},"Welcome to ChatApp"),r.a.createElement("p",null,"let's chat..."),r.a.createElement("div",{className:"mt-4"},r.a.createElement(o.b,{to:"/signup",className:"btn btn-primary px-5 mr-3"},"Create New Account"),r.a.createElement(o.b,{to:"/login",className:"btn px-5"},"Login to Your Account"))))),r.a.createElement(d,null))}}var b=a(4),E=a.n(b),v=a(9);class f extends n.Component{constructor(e){super(e),this.state={user:u().currentUser,chats:[],content:"",readError:null,writeError:null,loadingChats:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.myRef=r.a.createRef()}componentDidMount(){this.setState({readError:null,loadingChats:!0});const e=this.myRef.current;try{h.ref("chats").on("value",t=>{let a=[];t.forEach(e=>{a.push(e.val())}),a.sort((e,t)=>e.timestamp-t.timestamp),this.setState({chats:a}),e.scrollBy(0,e.scrollHeight),this.setState({loadingChats:!1})})}catch(t){this.setState({readError:t.message,loadingChats:!1})}}handleChange(e){this.setState({content:e.target.value})}handleSubmit(e){var t=this;return Object(v.a)(E.a.mark((function a(){var n;return E.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),t.setState({writeError:null}),n=t.myRef.current,a.prev=3,a.next=6,h.ref("chats").push({content:t.state.content,timestamp:Date.now(),uid:t.state.user.uid});case 6:t.setState({content:""}),n.scrollBy(0,n.scrollHeight),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(3),t.setState({writeError:a.t0.message});case 13:case"end":return a.stop()}}),a,null,[[3,10]])})))()}formatTime(e){const t=new Date(e),a=2!==t.getDate().toString().length?"0"+t.getDate():t.getDate(),n=2!==t.getMonth().toString().length?"0"+(t.getMonth()+1):t.getMonth()+1;return"".concat(a,"/").concat(n,"/").concat(t.getFullYear()," ").concat(t.getHours(),":").concat(t.getMinutes())}render(){return r.a.createElement("div",null,r.a.createElement(p,null),r.a.createElement("div",{className:"chat-area",ref:this.myRef},this.state.loadingChats?r.a.createElement("div",{className:"spinner-border text-success",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):"",this.state.chats.map(e=>r.a.createElement("p",{key:e.timestamp,className:"chat-bubble "+(this.state.user.uid===e.uid?"current-user":"")},e.content,r.a.createElement("br",null),r.a.createElement("span",{className:"chat-time floating-right"},"At: ",this.formatTime(e.timestamp)),r.a.createElement("br",null),r.a.createElement("span",{className:"chat-time floating-right"},"By: ",e.uid)))),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"mx-3"},this.state.writeError?r.a.createElement("p",null,this.state.writeError):null,r.a.createElement("textarea",{onChange:this.handleChange,value:this.state.content,className:"form-control",name:"content"}),r.a.createElement("button",{type:"submit",className:"btn btn-submit px-5 mt-4"},"Send")),r.a.createElement("div",{className:"py-5 mx-3"},"Login in as: ",r.a.createElement("strong",{className:"text-info"},this.state.user.email)))}}function N(){const e=new u.GoogleAuthProvider;return u().signInWithPopup(e)}function S(){const e=new u.GithubAuthProvider;return u().signInWithPopup(e)}class x extends n.Component{constructor(e){super(e),this.state={error:null,email:"",password:""},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.googleSignIn=this.googleSignIn.bind(this),this.githubSignIn=this.githubSignIn.bind(this)}handleChange(e){this.setState({[e.target.name]:e.target.value})}handleSubmit(e){var t=this;return Object(v.a)(E.a.mark((function a(){return E.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),t.setState({error:""}),a.prev=2,a.next=5,n=t.state.email,r=t.state.password,u().createUserWithEmailAndPassword(n,r);case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),t.setState({error:a.t0.message});case 10:case"end":return a.stop()}var n,r}),a,null,[[2,7]])})))()}googleSignIn(){var e=this;return Object(v.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.setState({error:t.t0.message});case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}githubSignIn(){var e=this;return Object(v.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0),e.setState({error:t.t0.message});case 9:case"end":return t.stop()}}),t,null,[[0,5]])})))()}render(){return r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"mt-5 py-5 px-5"},r.a.createElement("h1",null,"Sign Up to",r.a.createElement(o.b,{to:"/",className:"title ml-2"},"ChatApp")),r.a.createElement("p",{className:"lead"},"Fill in the form to create an account"),r.a.createElement("div",{className:"form-group"},this.state.error?r.a.createElement("p",null,this.state.error):null),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{className:"form-control",type:"email",placeholder:"Email",name:"email",value:this.state.email,onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{className:"form-control",type:"password",placeholder:"Password",name:"password",value:this.state.password,onChange:this.handleChange})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary px-5"},"Sign up")),r.a.createElement("p",null,"You can also login with below services"),r.a.createElement("button",{type:"button",onClick:this.googleSignIn,className:"btn btn-danger mr-2"},"Login with Google"),r.a.createElement("button",{type:"button",onClick:this.githubSignIn,className:"btn btn-secondary"},"Login with GitHub"),r.a.createElement("hr",null),r.a.createElement("p",null,"Already have an account? ",r.a.createElement(o.b,{to:"/login"},"Login"))))}}class w extends n.Component{constructor(e){super(e),this.state={error:null,email:"",password:""},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.googleSignIn=this.googleSignIn.bind(this),this.gitHubSignIn=this.gitHubSignIn.bind(this)}handleChange(e){this.setState({[e.target.name]:e.target.value})}handleSubmit(e){var t=this;return Object(v.a)(E.a.mark((function a(){return E.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),t.setState({error:""}),a.prev=2,a.next=5,n=t.state.email,r=t.state.password,u().signInWithEmailAndPassword(n,r);case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),t.setState({error:a.t0.message});case 10:case"end":return a.stop()}var n,r}),a,null,[[2,7]])})))()}googleSignIn(){var e=this;return Object(v.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.setState({error:t.t0.message});case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}gitHubSignIn(){var e=this;return Object(v.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.setState({error:t.t0.message});case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}render(){return r.a.createElement("div",{className:"container"},r.a.createElement("form",{autoComplete:"off",onSubmit:this.handleSubmit,className:"mt-5 py-5 px-5"},r.a.createElement("h1",null,"Login to ",r.a.createElement(o.b,{to:"/",className:"title ml-2"},"ChatApp")),r.a.createElement("p",{className:"lead"},"Fill in the form to login to your account"),r.a.createElement("div",{className:"form-group"},this.state.error?r.a.createElement("p",{className:"text-danger"},this.state.error):null),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",placeholder:"Email",name:"email",value:this.state.email,onChange:this.handleChange,className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",placeholder:"Password",name:"password",value:this.state.password,onChange:this.handleChange,className:"form-control"})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary px-5"},"Login")),r.a.createElement("p",null,"Or"),r.a.createElement("button",{onClick:this.googleSignIn,type:"button",className:"btn btn-danger mr-2"},"Sign in with Google"),r.a.createElement("button",{onClick:this.gitHubSignIn,className:"btn btn-secondary"},"Sign in with GitHub"),r.a.createElement("hr",null),r.a.createElement("p",null,"Don't have an account yet? ",r.a.createElement(o.b,{to:"/signup"},"Sign up"))))}}a(41);function y(e){let t=e.component,a=e.authenticated,n=Object(c.a)(e,["component","authenticated"]);return r.a.createElement(i.b,Object.assign({},n,{render:e=>!0===a?r.a.createElement(t,e):r.a.createElement(i.a,{to:{pathname:"/login",state:{from:e.location}}})}))}function C(e){let t=e.component,a=e.authenticated,n=Object(c.a)(e,["component","authenticated"]);return r.a.createElement(i.b,Object.assign({},n,{render:e=>!1===a?r.a.createElement(t,e):r.a.createElement(i.a,{to:"/chat"})}))}class k extends n.Component{constructor(){super(),this.state={authenticated:!1,loading:!0}}componentDidMount(){u().onAuthStateChanged(e=>{e?this.setState({authenticated:!0,loading:!1}):this.setState({authenticated:!1,loading:!1})})}render(){return!0===this.state.loading?r.a.createElement("div",{className:"spinner-border text-success",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement(o.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:g}),r.a.createElement(y,{path:"/chat",authenticated:this.state.authenticated,component:f}),r.a.createElement(C,{path:"/signup",authenticated:this.state.authenticated,component:x}),r.a.createElement(C,{path:"/login",authenticated:this.state.authenticated,component:w})))}}var I=k;const A=document.getElementById("root");l.a.render(r.a.createElement(I,null),A)}},[[25,1,2]]]);
//# sourceMappingURL=main.5a422a72.chunk.js.map